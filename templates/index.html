<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Child Safety Checker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Child Safety Checker</h1>
        </div>
        <div class="content">
            <form action="/results" method="post">
                <div class="form-group">
                    <label for="name">Child's Name:</label>
                    <input type="text" id="name" name="name" required>
                </div>

                <div class="form-group">
                    <label for="age_months">Age (months):</label>
                    <input type="number" id="age_months" name="age_months" min="0" required>
                </div>

                <div class="form-group">
                    <label for="weight">Weight:</label>
                    <div class="input-group">
                        <input type="number" id="weight" name="weight_kg" min="0" step="0.1" required>
                        <select id="weight_unit" onchange="convertWeight()">
                            <option value="kg">kg</option>
                            <option value="lb">lb</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="height">Height:</label>
                    <div class="input-group">
                        <input type="number" id="height" name="height_cm" min="0" step="0.1" required>
                        <select id="height_unit" onchange="convertHeight()">
                            <option value="cm">cm</option>
                            <option value="in">inches</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="product">Select Product:</label>
                    <select id="product" name="product" required>
                        <option value="">Choose a product...</option>
                        {% for product in products %}
                        <option value="{{ product.name }}">{{ product.name }} ({{ product.category }})</option>
                        {% endfor %}
                    </select>
                </div>

                <button type="submit">Check Safety</button>
            </form>
        </div>
    </div>

    <script>
        function convertWeight() {
            const weightInput = document.getElementById('weight');
            const weightUnit = document.getElementById('weight_unit');
            const currentValue = parseFloat(weightInput.value);
            
            if (isNaN(currentValue)) return;
            
            if (weightUnit.value === 'lb') {
                // Convert kg to lb (1 kg = 2.20462 lb)
                const lbValue = currentValue * 2.20462;
                weightInput.value = lbValue.toFixed(1);
            } else {
                // Convert lb to kg (1 lb = 0.453592 kg)
                const kgValue = currentValue * 0.453592;
                weightInput.value = kgValue.toFixed(1);
            }
        }

        function convertHeight() {
            const heightInput = document.getElementById('height');
            const heightUnit = document.getElementById('height_unit');
            const currentValue = parseFloat(heightInput.value);
            
            if (isNaN(currentValue)) return;
            
            if (heightUnit.value === 'in') {
                // Convert cm to inches (1 cm = 0.393701 inches)
                const inValue = currentValue * 0.393701;
                heightInput.value = inValue.toFixed(1);
            } else {
                // Convert inches to cm (1 inch = 2.54 cm)
                const cmValue = currentValue * 2.54;
                heightInput.value = cmValue.toFixed(1);
            }
        }

        // Add event listeners for real-time conversion
        document.getElementById('weight').addEventListener('input', function() {
            const weightUnit = document.getElementById('weight_unit');
            const weightInput = document.getElementById('weight');
            const currentValue = parseFloat(weightInput.value);
            
            if (isNaN(currentValue)) return;
            
            // Always store in kg for the backend
            if (weightUnit.value === 'lb') {
                const kgValue = currentValue * 0.453592;
                weightInput.setAttribute('data-kg', kgValue.toFixed(1));
            } else {
                weightInput.setAttribute('data-kg', currentValue.toFixed(1));
            }
        });

        document.getElementById('height').addEventListener('input', function() {
            const heightUnit = document.getElementById('height_unit');
            const heightInput = document.getElementById('height');
            const currentValue = parseFloat(heightInput.value);
            
            if (isNaN(currentValue)) return;
            
            // Always store in cm for the backend
            if (heightUnit.value === 'in') {
                const cmValue = currentValue * 2.54;
                heightInput.setAttribute('data-cm', cmValue.toFixed(1));
            } else {
                heightInput.setAttribute('data-cm', currentValue.toFixed(1));
            }
        });

        // Update form submission to use converted values
        document.querySelector('form').addEventListener('submit', function(e) {
            const weightInput = document.getElementById('weight');
            const heightInput = document.getElementById('height');
            
            // Use the converted values stored in data attributes
            if (weightInput.getAttribute('data-kg')) {
                weightInput.value = weightInput.getAttribute('data-kg');
            }
            if (heightInput.getAttribute('data-cm')) {
                heightInput.value = heightInput.getAttribute('data-cm');
            }
        });
    </script>
</body>
</html> 